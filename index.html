<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<script type="text/javascript" src='js/lib/three.js'></script>
		<script type="text/javascript" src='js/lib/three.obj-loader.js'></script>
	</head>
	<body>
		<script type='text/javascript'>

			var MIC = {};

			MIC.buildings = {
				init: function() {
					
					this.container = document.createElement('div');
					document.body.appendChild(this.container);

					this.camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 2000 );
					this.camera.position.z = 100;

					var ambient = new THREE.AmbientLight(0x101030);
					var directional = new THREE.DirectionalLight(0xffeedd);
					directional.position.set(0,0,1);

					var scene = this.scene = new THREE.Scene();

					scene.add(ambient);
					scene.add(directional);

					var manager = new THREE.LoadingManager();

					var texture = new THREE.Texture();

					var loader = new THREE.ImageLoader(manager);
					loader.load('textures/texture.jpg', function(image) {
						texture.image = image;
						texture.needsUpdate = true;
					});

					var loader = new THREE.OBJLoader(manager);

					loader.load('obj/male02.obj', function(obj) {
						obj.traverse(function(child) {
							if (child instanceof THREE.Mesh) {
								child.material.map = texture;
							}
						})
						obj.position.y = - 80;
						scene.add(obj);
					});

					var renderer = this.renderer = new THREE.WebGLRenderer();
					renderer.setSize(window.innerWith, window.innerHeight);

					this.container.appendChild(renderer.domElement);


					document.addEventListener('mousemove', function(e) {
						MIC.buildings.mouseX = (e.clientX - window.innerWidth / 2) / 2;
						MIC.buildings.mouseY = (e.clientY - window.innerHeight) / 2;
					}, false);

					this.animate = this.animate.bind(this);

					return this;
				},
				animate: function() {
					requestAnimationFrame(this.animate);
					this.render();
				},

				render: function() {
					this.camera.position.x += (this.mouseX - this.camera.position.x) * 0.05;
					this.camera.position.x += (-this.mouseY - this.camera.position.y) * 0.05;
					this.camera.lookAt(this.scene.position);
					this.renderer.render(this.scene, this.camera);
				}
			};

			MIC.buildings.init().animate();

		</script>
	</body>
</html>
